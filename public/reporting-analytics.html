<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Lunch Rush Database</title>
    <link href="styles.css" rel="stylesheet" />
    <link rel="icon" href="../favicon.ico" type="image/x-icon" />
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
    <script src="/common.js"></script>
  </head>
  <body>
    <header>
      <div id="header-image">
        <img src="Lunch_Rush_3.png" />
      </div>
    </header>
    <div id="grid-container">
      <nav>
        <ul>
          <li><a href="/index.html">Home</a></li>
          <li><a href="/stores.html">Stores</a></li>
          <li><a href="/menu.html">Menu</a></li>
          <li><a href="/inventory.html">Log Inventory</a></li>
          <li><a href="/inventorytransaction.html">Exchange Inventory</a></li>
          <li><a href="/ordering.html">Ordering</a></li>
          <li><a href="/deliveries.html">Deliveries</a></li>
          <li><a href="/reporting-analytics.html">Reporting &<br>Analytics</a></li>
          <li><a href="/account-settings.html">Account Settings</a></li>
          <li id="logout"><a href=#>Logout</a></li>
        </ul>
      </nav>

      <main>
        <div class="flex-container">
          <label for="locations"><h2>Reporting & Analytics</h2></label>
          <!-- <select name="locations" id="locations">
            <option value=1>678 Mountain Vista Ave</option>
            <option value=2>981 Sunset Rd</option>
            <option value=3>45 Eastern Rd</option>
          </select> -->
          <button id="viewInventoryDiscrepenciesBtn">View Inventory Discrepancies</button>
        </div>
        <img
          src="sandwich.png"
          alt="a cartoon cold cuts sandwich"
          class="center"
        />
      </main>
    </div>
    <footer>
      <p>Group 14 IFT 402 Fall 2023</p>
    </footer>

    <script>
      // var employeesArray = [];
      // var transactionsArray = [];
      // var ordersArray = [];
      // var inventoryLogsArray = [];
      // var inventoryTransactionsArray = [];

      // document.getElementById("viewStoreInfoBtn").addEventListener("click", async function () {
      //   const locationID = parseInt(document.getElementById("locations").value, 10);
      //   await populateArrays(locationID);
      //   generateTables();
      // });

      // async function populateArrays(locationID) {
      //   employeesArray = await fetchData('employees', locationID);
      //   transactionsArray = await fetchData('transactions', locationID);
      //   ordersArray = await fetchData('orders', locationID);
      //   inventoryLogsArray = await fetchData('inventoryLogs', locationID);
      //   inventoryTransactionsArray = await fetchData('inventoryTransactions', locationID);
      // }

      // async function fetchData(endpoint, locationID, array) {
      //   const response = await fetch(`/api/${endpoint}/${endpoint}/${locationID}`);
      //   return response.json();
      // }

      // function formatDateTime(dateTimeString) {
      //   const options = { month: 'numeric', day: 'numeric', year: 'numeric', hour: 'numeric', minute: 'numeric', second: 'numeric' };
      //   return new Date(dateTimeString).toLocaleDateString('en-US', options);
      // }

      // function formatDate(dateString) {
      //   const options = { month: 'numeric', day: 'numeric', year: 'numeric' };
      //   return new Date(dateString).toLocaleDateString('en-US', options);
      // }

      // function generateTables() {
      //   // Clear existing tables
      //   document.getElementById("locationTables").innerHTML = "";

      //   var tableData = {
      //     employees: employeesArray,
      //     transactions: transactionsArray,
      //     orders: ordersArray,
      //     inventoryLogs: inventoryLogsArray,
      //     inventoryTransactions: inventoryTransactionsArray
      //   };

      //   for (var key in tableData) {
      //     var tableContainer = document.createElement("div");
      //     tableContainer.className = "table-container-div";

      //     var tableTitle = document.createElement("span");
      //     tableTitle.textContent = key.replace(/([a-z])([A-Z])/g, '$1 $2').replace(/([A-Z])([A-Z][a-z])/g, '$1 $2'); // Add space between camelCase words
      //     tableTitle.textContent = tableTitle.textContent.charAt(0).toUpperCase() + tableTitle.textContent.slice(1); // Capitalize the first letter
      //     tableContainer.appendChild(tableTitle);

      //     var table = document.createElement("table");
      //     var header = document.createElement("thead");
      //     var headerRow = document.createElement("tr");

      //     var columns;
      //     switch (key) {
      //       case "employees":
      //         columns = ["Employee ID", "First Name", "Last Name", "Job Role"];
      //         break;
      //       case "transactions":
      //         columns = ["Transaction ID", "Date and Time", "Balance", "Employee ID"];
      //         break;
      //       case "orders":
      //         columns = ["Order ID", "Username", "Date and Time"];
      //         break;
      //       case "inventoryLogs":
      //         columns = ["Inventory Log ID", "Date and Time"];
      //         break;
      //       case "inventoryTransactions":
      //         columns = ["Inventory Transaction ID", "Outgoing Location ID", "Incoming Location ID", "Date"];
      //         break;
      //       default:
      //         columns = []; // Empty array for unknown table types
      //     }

      //     columns.forEach(function (column) {
      //       var th = document.createElement("th");
      //       th.textContent = column;
      //       headerRow.appendChild(th);
      //     });

      //     header.appendChild(headerRow);
      //     table.appendChild(header);

      //     tableData[key].forEach(function (data) {
      //       var row = document.createElement("tr");

      //       for (var prop in data) {
      //         var cell = document.createElement("td");
              
      //         if (prop.toLowerCase().includes("id")) {
      //           if (key !== "employees" && !["employeeid", "outgoinglocationid", "incominglocationid"].includes(prop.toLowerCase())) {
      //             var link = document.createElement("a");
      //             link.href = "#"; // Set the href attribute to "#" for now
      //             link.textContent = data[prop];

      //           function createEventListener(id, tableKey) {
      //             return function (event) {
      //               event.preventDefault();
      //               openPopup(id, tableKey);
      //             };
      //           }

      //           link.addEventListener("click", createEventListener(data[prop], key));

      //           cell.textContent = ""; // Clear the cell content
      //           cell.appendChild(link);
      //           } else {
      //             cell.textContent = data[prop];
      //           }
      //         } else if (prop.toLowerCase() === "jobrole" && key === "employees") {
      //           switch (data[prop]) {
      //             case 1:
      //               cell.textContent = "FOH";
      //               break;
      //             case 2:
      //               cell.textContent = "BOH";
      //               break;
      //             case 3:
      //               cell.textContent = "Manager";
      //               break;
      //             default:
      //               cell.textContent = "Unknown";
      //           }
      //         } else if (key === "inventoryTransactions" && prop.toLowerCase() === "transactiondate") {
      //           cell.textContent = formatDate(data[prop]);
      //         } else if (prop.toLowerCase().includes("date") || prop.toLowerCase().includes("time")) {
      //           cell.textContent = formatDateTime(data[prop]);
      //         } else if (key === "transactions" && prop.toLowerCase() === "balance") {
      //           const formattedBalance = parseFloat(data[prop]).toFixed(2);
      //           cell.textContent = "$" + formattedBalance;
      //         } else {
      //           cell.textContent = data[prop];
      //         }

      //         row.appendChild(cell);
      //       }

      //       table.appendChild(row);
      //     });

      //     tableContainer.appendChild(table);

      //     document.getElementById("locationTables").appendChild(tableContainer);
      //   }
      // }

      // document.getElementById("viewStoreInfoBtn").addEventListener("click", function() {
      //   var locationID = parseInt(document.getElementById("locations").value, 10);
      //   populateArrays(locationID);
      //   generateTables(locationID);
      // });

      // async function openPopup(id, key) {
      //   const lineItemsPromise = fetchLineItems(id, key);

      //   const lineItems = await lineItemsPromise;

      //   if (Array.isArray(lineItems)) {
      //     const lineItemsTable = generateLineItemsTable(lineItems);
      //     lineItemsTable.id = "lineItemsTable";
      //     const popupWindow = window.open("", "_blank", "width=600,height=400");
      //     const style = popupWindow.document.createElement("style");

      //     style.textContent = `
      //       #lineItemsTable {
      //         margin-top: 20px !important;
      //       }

      //       #lineItemsTable table {
      //         width: 100% !important;
      //         border-collapse: collapse !important;
      //         margin-bottom: 10px !important;
      //       }

      //       #lineItemsTable th, #lineItemsTable td {
      //         border: 1px solid black !important;
      //         padding: 8px !important;
      //         text-align: left !important;
      //       }

      //       #lineItemsTable th {
      //         background-color: #f2f2f2 !important;
      //       }
      //     `;
          
      //     popupWindow.document.head.appendChild(style);

      //     popupWindow.document.body.appendChild(lineItemsTable);
      //   } else {
      //     console.error("Error: lineItems is not an array");
      //   }
      // }

      // async function fetchLineItems(id, key) {
      //   const response = await fetch(`/api/${key}/${key}/lineItems/${id}`);
      //   return response.json();
      // }

      // function generateLineItemsTable(lineItems) {
      //   var table = document.createElement("table");
      //   var headerRow = document.createElement("tr");

      //   for (var prop in lineItems[0]) {
      //     var th = document.createElement("th");
      //     th.textContent = prop.replace(/([a-z])([A-Z])/g, '$1 $2').replace(/([A-Z])([A-Z][a-z])/g, '$1 $2');
      //     th.textContent = th.textContent.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
      //     headerRow.appendChild(th);
      //   }

      //   table.appendChild(headerRow);

      //   // Create a row for each line item
      //   lineItems.forEach(function (item) {
      //     var row = document.createElement("tr");

      //     for (var prop in item) {
      //       var cell = document.createElement("td");
      //       cell.textContent = item[prop];
      //       row.appendChild(cell);
      //     }

      //     table.appendChild(row);
      //   });

      //   return table;
      // }
    </script>
  </body>
</html>